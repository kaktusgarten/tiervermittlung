Du bist ein erfahrenber Entwickler. Hier mein Code:

SearchAnimalPage.tsx

import { useActionState, useEffect, useState } from "react";
import { useParams, useSearchParams } from "react-router";

import MainImage from "../components/MainImage";
import CardAnimal from "../components/CardAnimal";
import AnimalsLocationMap from "../components/AnimalsLocationMap";

export default function SearchAnimalPage() {
  const [animals, setAnimals] = useState<Animal[]>();
  const [categories, setCategories] = useState<Category[]>();
  const [characteristics, setCharacteristics] = useState<Characteristic[]>();
  const [value, setValue] = useState("");
  const [searchString, setSearchString] = useState("");
  const [state, formAction] = useActionState(action, null);

  const { slug } = useParams<{ slug?: string }>();
  const [searchParms, setSearchParms] = useSearchParams();

  //  let navigate = useNavigate();

  useEffect(() => {
    const fetchAnimals = async () => {
      try {
        // const fullSearch = !searchString
        //   ? `?category=${searchParms.get("category")}`
        //   : searchString;

        let fullSearch = "";

        if (searchString) {
          fullSearch = searchString;
        } else if (searchParms.has("category")) {
          fullSearch = `?category=${searchParms.get("category")}`;
        }

        const res = await fetch(
          //          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/animals${searchString}`
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/animals${fullSearch}`
        );
        const data = await res.json();
        setAnimals(data);
        // Letzte Auswahl zurücksetzen
        if (!searchString) {
          setSearchString("");
        }
      } catch (error) {
        setAnimals([]);
        console.log(error);
      }
    };

    fetchAnimals();
  }, [searchString, searchParms]);

  useEffect(() => {
    const fetchCategories = async () => {
      try {
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/categories`
        );
        const data = await res.json();
        setCategories(data);
      } catch (error) {
        console.log(error);
      }
    };

    fetchCategories();
  }, []);

  useEffect(() => {
    const fetchCharacteristics = async () => {
      try {
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/characteristics`
        );
        const data = await res.json();
        setCharacteristics(data);
      } catch (error) {
        console.log(error);
      }
    };

    fetchCharacteristics();
  }, []);

  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const result = event.target?.value.replace(/\D/g, "");

    setValue(result);
  };

  async function action(previousState, formData: FormData) {
    let resultString = "?";
    const selectedCharacteristics = formData.getAll("characteristics");
    const category = formData.get("selectedCategory");
    const sex = formData.get("selectedSex");
    const age = formData.get("inputAge");
    const race = formData.get("inputRace");

    if (selectedCharacteristics.length > 0) {
      selectedCharacteristics.forEach((Char) => {
        const Chara = characteristics?.find((c) => c._id === Char.toString());
        resultString = resultString.concat(
          "characteristics=",
          Chara?.characteristic,
          "&"
        );
      });
      resultString = resultString.substring(0, resultString.length - 1);
    }
    if (!(category.substring(0, 2) === "--")) {
      if (resultString.length > 1) {
        resultString = resultString.concat("&");
      }
      resultString = resultString.concat("category=", category);
    }
    if (!(sex.substring(0, 2) === "--")) {
      if (resultString.length > 1) {
        resultString = resultString.concat("&");
      }
      resultString = resultString.concat("sex=", sex);
    }
    if (age.length > 0) {
      if (resultString.length > 1) {
        resultString = resultString.concat("&");
      }
      resultString = resultString.concat("age=", age);
    }
    if (race.length > 0) {
      if (resultString.length > 1) {
        resultString = resultString.concat("&");
      }
      resultString = resultString.concat("race=", race);
    }
    setSearchString(resultString);
  }

  return (
    <>
      <main className="">
        <h1 className="mt-10 mb-10">
          Wir suchen ein Zuhause {slug && `- Rubrik: ${slug.toUpperCase()}`}
        </h1>

        <section id="Auswahl" className="mb-2">
          <form action={formAction}>
            <fieldset>
              <div className="w-full">
                <div className="border border-amber-600">
                  <legend className="fieldset-legend">
                    Auswahl Characteristic
                  </legend>
                  {/* Checkboxen Characteristik */}
                  {!characteristics
                    ? ""
                    : characteristics?.map((char) => (
                        <label className="label mr-1" key={char._id}>
                          <input
                            name="characteristics"
                            value={char._id}
                            type="checkbox"
                            className="checkbox"
                            id={char._id}
                          />
                          {char.characteristic}
                        </label>
                      ))}
                </div>
                <div className="border border-blue-600">
                  {/* Auswahl Kategorien */}
                  <label htmlFor="Category" className="select w-20 mr-1 ">
                    Kategorie
                  </label>

                  <select
                    name="selectedCategory"
                    defaultValue="Auswahl Kategorie"
                    className="select w-44"
                  >
                    <option>-- Kategorie wählen --</option>
                    {!categories
                      ? ""
                      : categories?.map((cat) => (
                          <option key={cat._id}>{cat.categoryName}</option>
                        ))}
                  </select>
                  {/* Auswahl Geschlecht */}
                  <label
                    htmlFor="Sex"
                    className="input border border-amber-500 w-24 mr-1"
                  >
                    Geschlecht
                  </label>
                  <select
                    name="selectedSex"
                    defaultValue="Auswahl Geschlecht"
                    className="select w-44"
                  >
                    <option>-- Bitte wählen --</option>
                    <option key="männlich">männlich</option>
                    <option key="weiblich">weiblich</option>
                    <option key="egal">egal</option>
                  </select>
                  {/* Eingabe Alter */}
                  <label htmlFor="Age">
                    Alter
                    <input
                      name="inputAge"
                      type="text"
                      value={value}
                      onChange={handleChange}
                      className="input w-18 mr-3"
                    />
                  </label>
                  {/* Eingabe Rasse */}
                  <label htmlFor="Race">
                    Rasse
                    <input
                      name="inputRace"
                      type="text"
                      className="input w-50 mr-3"
                    />
                  </label>
                  <button type="submit" className="btn btn-neutral">
                    Tiere suchen
                  </button>
                </div>
              </div>
            </fieldset>
          </form>
        </section>
        <section>
          <div className="h-120">
            <AnimalsLocationMap
              category={searchParms.get("category") ?? ""}
              url={searchString}
            />
          </div>
        </section>
        <section className="grid xl:grid-cols-3 md:grid-cols-2 gap-9 mb-10">
          {animals?.map((animal) => (
            <CardAnimal key={animal._id} animal={animal}></CardAnimal>
          ))}
        </section>

        <div className="mt-10">
          <MainImage
            image="./img/Maeuse.jpg"
            headline="Tier vermitteln, Tier ein zu Hause geben"
            textColor="white"
            text="Finde ein neues Zuhause für dein Tier - Wir helfen!"
          />
        </div>
      </main>
    </>
  );
}

AnimalsLocationMap.tsx

import { useEffect, useState } from "react";
import { MapContainer, TileLayer, Marker, Popup, useMap } from "react-leaflet";
import "leaflet/dist/leaflet.css";
import type { icon, LatLngExpression } from "leaflet";
import L from "leaflet";
import { useLocation } from "react-router";

// npm install react@rc react-dom@rc leaflet
// npm install react-leaflet@next
// Typen
// npm install -D @types/leaflet

interface OwnerPosition {
  lat: number;
  lng: number;
}

interface AnimalsLocationMapProps {
  category: string;
  url: string;
}

const ComponentResize = () => {
  const map = useMap();

  setTimeout(() => {
    map.invalidateSize();
  }, 0);

  return null;
};

const AnimalsLocationMap = ({ category, url }: AnimalsLocationMapProps) => {
  // Prüfen ob sich Seite geändert hat
  const location = useLocation();
  // die Status
  const [animalspos, setAnimalsForMap] = useState([]);
  const [ownerPos, setOwnerPosForMap] = useState<OwnerPosition | null>(null);
  const [userData, setUserData] = useState<User | null>(null);

  console.log("category: ", category);
  console.log("url: ", url);

  //  const query = new URLSearchParams(location.search);
  //            const category = query.get("category") ?? "";

  // Daten des angemeldeten Users holen
  useEffect(() => {
    const fetchMe = async () => {
      try {
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/auth/me`,
          { credentials: "include" }
        );
        const data = await res.json();
        setUserData(data); // data.user._id)
      } catch (error) {
        console.log(error);
      }
    };

    fetchMe();
  }, [location]);

  // Alle Tiere laden
  useEffect(() => {
    const fetchAnimalsForMap = async () => {
      try {
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/animalsmap`
        );
        const data = await res.json();
        const categoryFiltered = data.filter(
          (Tier: Animal) => Tier.category.toLowerCase() === category
        );
        if (categoryFiltered.length > 0) {
          console.log("if !category(else): ", categoryFiltered);
          setAnimalsForMap(categoryFiltered);
        } else {
          console.log("if !category: ", data);
          setAnimalsForMap(data);
        }
      } catch (error) {
        console.log(error);
      }
    };

    fetchAnimalsForMap();
  }, [category]);

  // Daten zu angemeldetem Benutzer holen
  useEffect(() => {
    if (!userData?.user._id) {
      return;
    }

    const fetchOwnerPosForMap = async () => {
      //      console.log("fetchOwnerPosForMap started.");
      try {
        //        const params = new URLSearchParams({ id: userData._id });
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/ownerformap`,
          { credentials: "include" }
        );
        const data = await res.json();
        setOwnerPosForMap(data[0]);
      } catch (error) {
        console.log("fetchOwnerPosForMap error: ", error);
      }
    };

    fetchOwnerPosForMap();
  }, [location, userData]);
  // Owner Position neu laden wenn sich User oder die URL(Kategorie) änderft

  // MarkerProps.position: LatLngExpression
  //  const position: LatLngExpression = [48.81615, 8.74748];
  // const position: LatLngExpression = ownerPos
  //   ? [ownerPos.lat, ownerPos.lng]
  //   : [48.81615, 8.74748];

  const position: LatLngExpression = [ownerPos?.lat, ownerPos?.lng];
  //  const animalpos: LatLngExpression = [48.81345, 8.74758];

  // console.log("animalspos: ", animalspos);

  const dogIcon = L.icon({
    iconUrl: "../img/Icon_Dog.png",

    iconSize: [82, 66], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62], // the same for the shadow
    popupAnchor: [-3, -76], // point from which the popup should open relative to the iconAnchor
  });

  const catIcon = L.icon({
    iconUrl: "../img/Icon_Cat.png",

    iconSize: [82, 66], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62], // the same for the shadow
    popupAnchor: [-3, -76], // point from which the popup should open relative to the iconAnchor
  });

  //  console.log("Zentrum: ", position);

  return (
    ownerPos && (
      <MapContainer
        style={{
          height: "100%",
          width: "100%",
        }}
        center={position}
        attributionControl={true}
        zoom={0}
        minZoom={0}
        scrollWheelZoom={true}
      >
        <ComponentResize />
        <TileLayer
          // className={'ion-hide'}
          attribution='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
          url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
        />

        <Marker position={position}>
          <Popup>
            A pretty CSS3 popup. <br /> Easily customizable.
          </Popup>
        </Marker>

        {animalspos.map((animal) => (
          <Marker
            position={[animal?.lat, animal?.lng]}
            icon={animal.category === "Hund" ? dogIcon : catIcon}
          >
            <Popup> Test</Popup>
          </Marker>
        ))}
        {/**
        <Marker position={animalpos} icon={dogIcon}>
          <Popup>
            Position animal 1. <br />
          </Popup>
        </Marker> 
 */}
      </MapContainer>
    )
  );
};
export default AnimalsLocationMap;

Header.tsx

import { useNavigate, NavLink } from "react-router";
import { useEffect, useState } from "react";
import { useAuth } from "../context";
import DarkThemeSchalter from "./DarkThemeSchalter";
//import LoginModal from "./LoginModal";
export default function Header() {
  // const categories = [{ categoryName: "Hunde", name: "Hund" }];

  const [categories, setCategories] = useState<Category[]>();
  const [activeSubmenu, setActiveSubmenu] = useState<string | null>(null);
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  const { signedIn, handleSignOut } = useAuth();
  const navigate = useNavigate();

  const logout = async () => {
    //alert("abmelden.....");
    try {
      await handleSignOut();
      navigate("/");
      setIsMenuOpen(false);
      setActiveSubmenu(null);
    } catch (error) {
      if (error instanceof Error) {
        //toast.error(error.message);
        console.log(error.message);
      } else {
        //toast.error("Error logging out");
        console.log("Error logging out");
      }
    }
  };

  useEffect(() => {
    const fetchCategories = async () => {
      try {
        const res = await fetch(
          `${import.meta.env.VITE_APP_AUTH_SERVER_URL}/categories`
        );
        const data = await res.json();
        setCategories(data);
      } catch (error) {
        console.log(error);
      }
    };

    fetchCategories();

    // Menu schließt alle Submenüs bei Klick:
    const handleClick = (e: Event) => {
      const target = e.target as HTMLElement;
      if (target.closest("a")) {
        document
          .querySelectorAll("details[open]")
          .forEach((d) => d.removeAttribute("open"));
      }

      // Close mobile menu when clicking outside
      if (isMenuOpen && !target.closest(".relative")) {
        setIsMenuOpen(false);
        setActiveSubmenu(null);
      }
    };

    document.addEventListener("click", handleClick);
    return () => document.removeEventListener("click", handleClick);
  }, [isMenuOpen]);

  const handleMenuToggle = () => {
    setIsMenuOpen(!isMenuOpen);
    if (!isMenuOpen) {
      setActiveSubmenu(null);
    }
  };

  const handleLinkClick = () => {
    setIsMenuOpen(false);
    setActiveSubmenu(null);
  };

  return (
    <>
      <header className="pt-4 pb-2 sticky top-0 border-b z-100 bg-[#1D3349] text-white -translate-y-2 shadow-[0_0_20px_#000] border-[#000]">
        <div className="container m-auto flex align-middle items-center">
          {/* LOGO ############################## */}
          <div className="pl-2 sm:pr-5">
            <NavLink to="/">
              <img
                src="./img/logo-rund-weiss.png"
                title="HOME"
                alt="HOME"
                className="w-16 min-w-16 object-contain"
              />
            </NavLink>
          </div>

          {/* NAVIGATION ######################## */}
          <nav>
            {/* Mobile Dropdown */}
            <div className="relative min-[800px]:hidden">
              <button
                className={`btn btn-ghost btn-square ml-5 ${
                  isMenuOpen ? "bg-[#182a3b]" : ""
                }`}
                onClick={handleMenuToggle}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  className="h-10 w-10"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth="2"
                    d="M4 6h16M4 12h16M4 18h7"
                  />
                </svg>
              </button>

              {isMenuOpen && (
                <ul className="menu menu-lg absolute left-0 top-full bg-[#1D3349] text-white rounded-box z-[1] mt-3 w-52 shadow-lg border-t-4 border-[#182a3b] overflow-hidden max-h-[70vh] overflow-y-auto scrollbar-thin scrollbar-thumb-base-300 scrollbar-track-transparent">
                  {/* Main Menu */}
                  <div
                    className={`transition-transform duration-300 ${
                      activeSubmenu ? "-translate-x-full" : "translate-x-0"
                    }`}
                  >
                    <li>
                      <button
                        onClick={() => setActiveSubmenu("tiersuchen")}
                        className="font-semibold flex justify-between items-center w-full hover:bg-[#182a3b]"
                      >
                        <span>Tier suchen</span>
                        <svg
                          className="w-4 h-4"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            strokeWidth={2}
                            d="M9 5l7 7-7 7"
                          />
                        </svg>
                      </button>
                    </li>
                    <li>
                      <button
                        onClick={() => setActiveSubmenu("ueberuns")}
                        className="font-semibold flex justify-between items-center w-full hover:bg-[#182a3b]"
                      >
                        <span>Über uns</span>
                        <svg
                          className="w-4 h-4"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            strokeWidth={2}
                            d="M9 5l7 7-7 7"
                          />
                        </svg>
                      </button>
                    </li>
                    <li>
                      <NavLink
                        to="/tier-einstellen"
                        className="font-semibold hover:bg-[#182a3b]"
                        onClick={handleLinkClick}
                      >
                        Tier vermitteln
                      </NavLink>
                    </li>
                    <li>
                      <NavLink
                        to="/mein-konto"
                        className="font-semibold hover:bg-[#182a3b]"
                        onClick={handleLinkClick}
                      >
                        Meine Kontodaten
                      </NavLink>
                    </li>
                    {signedIn ? (
                      <li>
                        <a
                          onClick={logout}
                          className="font-semibold text-error hover:bg-[#182a3b]"
                        >
                          Abmelden
                        </a>
                      </li>
                    ) : (
                      <>
                        <li>
                          <NavLink
                            to="/login"
                            className="font-semibold hover:bg-[#182a3b]"
                            onClick={handleLinkClick}
                          >
                            Anmelden
                          </NavLink>
                        </li>
                        <li>
                          <NavLink
                            to="/registrierung"
                            className="font-semibold hover:bg-[#182a3b]"
                            onClick={handleLinkClick}
                          >
                            Registrieren
                          </NavLink>
                        </li>
                      </>
                    )}
                  </div>

                  {/* Tier Suchen Submenu */}

                  <div
                    className={`absolute top-0 left-0 w-full bg-[#1D3349] text-white rounded-box transition-transform duration-300  ${
                      activeSubmenu === "tiersuchen"
                        ? "translate-x-0"
                        : "translate-x-full"
                    }`}
                  >
                    <li>
                      <button
                        onClick={() => setActiveSubmenu(null)}
                        className="font-semibold flex items-center mt-3 hover:bg-[#182a3b]"
                      >
                        <svg
                          className="w-4 h-4"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            strokeWidth={2}
                            d="M15 19l-7-7 7-7"
                          />
                        </svg>
                        <span>Zurück</span>
                      </button>
                    </li>
                    <div className="divider my-1"></div>
                    <li>
                      <NavLink
                        to="/tier-suchen"
                        className="rounded-md hover:bg-[#182a3b]"
                        onClick={handleLinkClick}
                      >
                        Alle&nbsp;Tiere&nbsp;zeigen
                      </NavLink>
                    </li>
                    {categories?.map((cat) => (
                      <li key={cat._id}>
                        <NavLink
                          to={`/tier-suchen?category=${cat.categoryName.toLocaleLowerCase()}`}
                          className="rounded-md hover:bg-[#182a3b]"
                          onClick={handleLinkClick}
                        >
                          {cat.categoryName}
                        </NavLink>
                      </li>
                    ))}
                  </div>

                  {/* Über Uns Submenu */}
                  <div
                    className={`absolute top-0 left-0 w-full bg-[#1D3349] text-white rounded-box transition-transform duration-300 ${
                      activeSubmenu === "ueberuns"
                        ? "translate-x-0"
                        : "translate-x-full"
                    }`}
                  >
                    <li>
                      <button
                        onClick={() => setActiveSubmenu(null)}
                        className="font-semibold flex items-center mt-3 hover:bg-[#182a3b]"
                      >
                        <svg
                          className="w-4 h-4"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            strokeWidth={2}
                            d="M15 19l-7-7 7-7"
                          />
                        </svg>
                        <span>Zurück</span>
                      </button>
                    </li>
                    <div className="divider my-1"></div>
                    <li>
                      <NavLink
                        to="/about"
                        className="rounded-md hover:bg-[#182a3b]"
                        onClick={handleLinkClick}
                      >
                        Über uns
                      </NavLink>
                    </li>
                    <li>
                      <NavLink
                        to="/impressum"
                        className="rounded-md hover:bg-[#182a3b]"
                        onClick={handleLinkClick}
                      >
                        Impressum
                      </NavLink>
                    </li>
                  </div>
                </ul>
              )}
            </div>
            {/* Desktop Navigation */}
            <div className="max-[800px]:hidden flex items-center gap-2">
              <ul className="menu menu-horizontal ">
                <li>
                  <details>
                    <summary>Tier suchen</summary>
                    <ul className="bg-[#fff] text-black font-semibold border border-[#1D3349] -translate-y-1 shadow-[4px_4px_8px_#c7c0ca]">
                      <li>
                        <NavLink to="/tier-suchen">
                          Alle&nbsp;Tiere&nbsp;zeigen
                        </NavLink>
                      </li>
                      {categories?.map((cat) => (
                        <li key={cat._id}>
                          <NavLink
                            to={`/tier-suchen?category=${cat.categoryName.toLocaleLowerCase()}`}
                          >
                            {cat.categoryName}
                          </NavLink>
                        </li>
                      ))}
                    </ul>
                  </details>
                </li>
                <li>
                  <details>
                    <summary>Über uns</summary>
                    <ul className="bg-[#fff] text-black font-semibold border border-[#1D3349] -translate-y-1 shadow-[4px_4px_8px_#c7c0ca]">
                      <li>
                        <NavLink to="/about">Über uns</NavLink>
                      </li>
                      <li>
                        <NavLink to="/impressum">Impressum</NavLink>
                      </li>
                    </ul>
                  </details>
                </li>
                <li>
                  <NavLink to="/tier-einstellen">Tier vermitteln</NavLink>
                </li>

                <li>
                  <NavLink to="/mein-konto">Meine Kontodaten</NavLink>
                </li>
                {signedIn ? (
                  <li>
                    <a onClick={logout}>Abmelden</a>
                  </li>
                ) : (
                  <>
                    <li>
                      <NavLink to="/login">Anmelden</NavLink>
                    </li>

                    <li>
                      <NavLink to="/registrierung">Registrieren</NavLink>
                    </li>
                  </>
                )}
                {/* {userData?.roles?.[0] === "admin" && (
                  <li>
                    <NavLink to="/admin-bereich" className="text-[orange]">
                      Admin Bereich
                    </NavLink>
                  </li>
                )} */}
              </ul>
            </div>
          </nav>

          {/* DARK MODE SCHALTER ################ */}
          <div className="flex-1 flex justify-end mr-5">
            <DarkThemeSchalter></DarkThemeSchalter>
          </div>
        </div>
      </header>
    </>
  );
}


Meine Frage ist wie kann ich eine AKtualisierung von AnimalsLocationMap auslösen wenn ich in Header.tsx eine Auswahl im Menü "Tier suchen" mache? 
